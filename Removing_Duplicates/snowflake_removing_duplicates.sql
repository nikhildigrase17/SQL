CREATE DATABASE DEMO_DATABASE;
USE DATABASE DEMO_DATABASE;

CREATE OR REPLACE TABLE ND_IPLA
(
SID INT PRIMARY KEY,
SNAME VARCHAR (20),
SAL DECIMAL(10,2),
AGE INT);

INSERT INTO ND_IPLA
VALUES
(1,'MAHI',12,40),
(2,'KOHLI',14,33),
(3,'DK',6.25,33),
(3,'DK',8.25,33),
(4,'WARNER',6.75,33),
(5,'RAHUL',16,29),
(5,'RAHUL',16,24),
(6,'PANDYA',14,27),
(6,'PANDYA',15,32),
(6,'PANDYA',23,35),
(1,'MAHI',12,52);


SELECT * FROM ND_IPLA;
DROP VIEW ND_IPLA_DEMO_DISTINCT;

CREATE OR REPLACE TABLE ND_IPLA_DEMO_DISTINCT AS    
SELECT DISTINCT * FROM ND_IPLA;

SELECT * FROM ND_IPLA_DEMO_DISTINCT;

SELECT DISTINCT SNAME, COUNT(*)         -- QUERY TO FIND DUPLICATES IN THE RECORDS
FROM ND_IPLA_DEMO_DISTINCT
GROUP BY SNAME
HAVING COUNT(*) > 1
ORDER BY SNAME;

DELETE FROM ND_IPLA_DEMO_DISTINCT
WHERE SNAME = 'MAHI' AND AGE = 52;

DELETE FROM ND_IPLA_DEMO_DISTINCT      -- KEEP ONLY 27
WHERE SNAME = 'PANDYA' AND AGE <> 27;

CREATE OR REPLACE TABLE AGENTS(
ID INT NOT NULL PRIMARY KEY,
FIRST_NAME VARCHAR(20),
LAST_NAME VARCHAR(30),
YEARS_EXPERIENCE INT
);

SELECT * FROM AGENTS;

INSERT INTO AGENTS(ID,FIRST_NAME,LAST_NAME,YEARS_EXPERIENCE) VALUES 
(1,'KATE','WHITE',5),
(2,'MELISA','BROWN',2),
(3,'ALEXNDR','MCGREGGOR',3),
(4,'SOFIA','SCOTT',3),
(5,'STEVEN','BLACK',1),
(6,'MARTA','SCOTT',1);

CREATE OR REPLACE TABLE CUSTOMERS(
ID INT NOT NULL PRIMARY KEY,
FIRST_NAME VARCHAR(20),
LAST_NAME VARCHAR(20),
EMAIL VARCHAR(60) UNIQUE);

INSERT INTO CUSTOMERS (ID,FIRST_NAME,LAST_NAME,EMAIL) VALUES
(11,'XAVIERA','LOPEZ','xaviera11111@gmail.com'),
(12,'GABREILLA','CUMBERLY','gabreilla1111@gmail.com'),
(13,'ELIZABETH','STEVENS','eliszabeth1111@gmail.com'),
(14,'OPRAH','WINFREY','oprah1111@gmail.com'),
(15,'IVAN','LEE','ivan1111@gmail.com');

CREATE OR REPLACE TABLE SALES(
ID INT NOT NULL PRIMARY KEY,
HOUSE_ID INT,
C_DATE DATE,
AGENT_FIRST_NAME VARCHAR(20),
AGENT_LAST_NAME VARCHAR(20),
CUSTOMER_ID INT,
PRICE INT);

INSERT INTO SALES VALUES
(101,1012,'2021-11-03','KATE','WHITE',14,1200000),
(102,2134,'2021-12-06','SOFIA','SCOTT',12,9500000),
(103,1015,'2021-12-10','MARTA','SCOTT',13,800000),
(104,2013,'2021-12-12','ALEXNDR','MCGREGGOR',15,1350000),
(105,2112,'2021-12-12','ALEXNDR','MCGREGGOR',15,1450000),
(106,1010,'2022-01-10','STEVEN','BLACK',11,1500000);

SELECT
A1.FIRST_NAME AS AGENT1_FIRST_NAME,
A1.LAST_NAME AS AGENT1_LAST_NAME,
A1.YEARS_EXPERIENCE AS AGENT1_EXPERIENCE,
A2.FIRST_NAME AS AGENT2_FIRST_NAME,
A2.LAST_NAME AS AGENT2_LAST_NAME,
A2.YEARS_EXPERIENCE AS AGENT2_EXPERIENCE
FROM AGENTS A1
JOIN AGENTS A2
ON A1.ID < A2.ID   -- TO REMOVE DUPLICATES
WHERE A1.YEARS_EXPERIENCE >= 3 AND A2.YEARS_EXPERIENCE <= 1
ORDER BY A1.ID;

-- https://data-flair.training/blogs/duplicate-records-in-sql/  (LINK TO VISIT WHILE REVISING)